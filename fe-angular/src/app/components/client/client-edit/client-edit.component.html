<h2 mat-dialog-title>
  @if (data.isNew) { Add Client } @else { Edit Client }
</h2>

<form [formGroup]="form" (ngSubmit)="save()" novalidate>
  <mat-dialog-content>
    <div class="grid">
      <!-- ID (edit only) -->
      @if (!data.isNew) {
      <div class="label">ID</div>
      <div class="value id">{{ data.id }}</div>
      }

      <!-- Full Name -->
      <div class="label">Full Name*</div>
      <div class="value">
        <mat-form-field appearance="fill" subscriptSizing="dynamic">
          <input matInput formControlName="fullName" required maxlength="128" />
          @if (getError('fullName'); as err) {
          <mat-error>{{ err }}</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Display Name -->
      <div class="label">Display Name*</div>
      <div class="value">
        <mat-form-field appearance="fill" subscriptSizing="dynamic">
          <input matInput formControlName="displayName" required maxlength="30" />
          @if (getError('displayName'); as err) {
          <mat-error>{{ err }}</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Email -->
      <div class="label">Email*</div>
      <div class="value">
        <mat-form-field appearance="fill" subscriptSizing="dynamic">
          <input matInput type="email" formControlName="email" required maxlength="254" />
          @if (getError('email'); as err) {
          <mat-error>{{ err }}</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Details -->
      <div class="label">Details</div>
      <div class="value">
        <mat-form-field appearance="fill" subscriptSizing="dynamic">
          <textarea matInput rows="3" formControlName="details" maxlength="500"></textarea>
          <mat-hint align="end">{{ form.get('details')?.value?.length || 0 }}/500</mat-hint>
          @if (form.get('details')?.hasError('maxlength')) {
          <mat-error>Max 500 characters</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Active -->
      <div class="label">Active*</div>
      <div class="value checkbox">
        <mat-checkbox formControlName="active" aria-label="Active"></mat-checkbox>
      </div>

      <!-- Location -->
      <div class="label">Location</div>
      <div class="value">
        <mat-form-field appearance="fill" subscriptSizing="dynamic">
          <input matInput formControlName="location" maxlength="120" />
          @if (form.get('location')?.hasError('maxlength')) {
          <mat-error>Max 120 characters</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Country -->
      <div class="label">Country*</div>
      <div class="value">
        <mat-form-field appearance="fill" subscriptSizing="dynamic" class="country-field">
          <mat-select formControlName="country" panelClass="country-panel" required>
            <mat-select-trigger>
              <span class="fi" [ngClass]="'fi-' + iso(form.get('country')?.value || '')"></span>
              {{ form.get('country')?.value || 'Selectâ€¦' }}
            </mat-select-trigger>

            @for (c of countries; track c.code) {
            <mat-option [value]="c.name">
              <span class="fi" [ngClass]="'fi-' + c.code"></span>
              {{ c.name }}
            </mat-option>
            }
          </mat-select>
          @if (form.get('country')?.hasError('required')) {
          <mat-error>Country is required</mat-error>
          }
        </mat-form-field>
      </div>
    </div>
  </mat-dialog-content>

  <!-- actions -->
  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="cancel()">Cancel</button>
    <button mat-flat-button class="btn-save" type="submit" [disabled]="form.invalid || submitting">Save</button>
  </mat-dialog-actions>
</form>