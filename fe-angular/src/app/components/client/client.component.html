<div class="container">
  <div class="page-header">
    <h2 class="title">List of Clients</h2>

    <div class="header-actions">
      <form (ngSubmit)="searchClient()" class="search">
        <mat-form-field appearance="outline" subscriptSizing="dynamic" class="search-field">
          <input matInput type="search" name="clientSearchQ" [(ngModel)]="clientSearchQ" placeholder="Search" aria-label="Search" />
          <button mat-icon-button matSuffix class="search-btn" type="submit" aria-label="Run search">
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </form>

      <button mat-flat-button class="btn-add" (click)="addClient()">Add</button>

      <button mat-flat-button color="warn" class="btn-remove" (click)="deleteSelectedClients()"
        [disabled]="!selection.hasValue()">
        Remove<span *ngIf="selection.selected.length"> ({{ selection.selected.length }})</span>
      </button>
    </div>
  </div>

  <div class="table-card">
    <table mat-table [dataSource]="dataSource" matSort>
      <!-- Checkbox -->
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef class="col-select">
          <mat-checkbox (change)="masterToggle()" [checked]="isAllSelected()"
            [indeterminate]="pageHasSelection() && !isAllSelected()">
          </mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let row" class="col-select">
          <mat-checkbox (click)="$event.stopPropagation()" (change)="selection.toggle(row)"
            [checked]="selection.isSelected(row)">
          </mat-checkbox>
        </td>
      </ng-container>

      <!-- ID -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-id">
          ID
        </th>
        <td mat-cell *matCellDef="let row" class="col-id">
          {{ row.id }}
        </td>
      </ng-container>


      <!-- Display Name -->
      <ng-container matColumnDef="displayName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-display">
          Display Name
        </th>
        <td mat-cell *matCellDef="let row" class="col-display">
          {{ row.displayName }}
        </td>
      </ng-container>

      <!-- Active -->
      <ng-container matColumnDef="active">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-active">
          Active
        </th>
        <td mat-cell *matCellDef="let row" class="col-active">
          <span class="chip" [class.chip-active]="row.active" [class.chip-inactive]="!row.active">
            {{ row.active ? 'Active' : 'Inactive' }}
          </span>
        </td>
      </ng-container>

      <!-- Country -->
      <ng-container matColumnDef="country">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-country">
          Country
        </th>
        <td mat-cell *matCellDef="let row" class="col-country">
          <span class="fi" [ngClass]="'fi-' + iso(row.country)"></span>
          {{ row.country }}
        </td>
      </ng-container>

      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="col-actions">
          <span class="visually-hidden">Actions</span>
        </th>
        <td mat-cell *matCellDef="let row" class="col-actions">
          <button mat-icon-button matTooltip="Edit" (click)="$event.stopPropagation(); editClient(row)">
            <mat-icon>edit</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns" class="row-clickable" (click)="openClientDetails(row)"
        tabindex="0" (keydown.enter)="openClientDetails(row)" (keydown.space)="openClientDetails(row)"></tr>
    </table>

    <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons></mat-paginator>
  </div>
</div>