<h2 class="title">Bulk upload clients (.xlsx)</h2>

<div class="body">
  <div class="picker">
    <input type="file" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      (change)="onFile($event)" #file hidden>
    <button mat-stroked-button (click)="onPickFile(file)">Choose Excel</button>
    <button mat-stroked-button (click)="downloadTemplate()">Download template</button>
    <span class="file" *ngIf="fileName()">{{ fileName() }}</span>
  </div>

  <p class="hint">
    Expected columns (sheet <code>Clients</code>):<br>
    <code>ID</code>, <code>Full Name</code>, <code>Display Name</code>, <code>Email</code>,
    <code>Details</code>, <code>Active</code>, <code>Location</code>, <code>Country</code>.
    <br>Note: <code>ID</code> is ignored on import.
  </p>

  <div *ngIf="rows().length">
    <p class="summary">
      Parsed <b>{{ rows().length }}</b> rows.
      <span *ngIf="imported()"> Imported: {{ imported() }}</span>
    </p>

    <table class="preview">
      <thead>
        <tr>
          <th>Display Name</th>
          <th>Email</th>
          <th>Active</th>
          <th>Country</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of preview()">
          <td>{{ r.displayName }}</td>
          <td>{{ r.email }}</td>
          <td>{{ r.active }}</td>
          <td>{{ r.country }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="actions">
  <button mat-button (click)="close()" [disabled]="loading()">Cancel</button>
  <button mat-flat-button color="primary" (click)="importNow()" [disabled]="!canImport()">Import</button>
</div>