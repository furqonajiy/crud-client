<h2 mat-dialog-title>Bulk upload clients (.xlsx)</h2>

<mat-dialog-content>
  <div class="body">
    <div class="picker">
      <input type="file" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        (change)="onFile($event)" #file hidden />

      <button mat-flat-button class="btn-upload" type="button" (click)="onPickFile(file)">
        <mat-icon aria-hidden="true">file_upload</mat-icon>
        Upload
      </button>

      @if (fileName()) {
      <span class="file">{{ fileName() }}</span>
      }
    </div>

    <div class="below-actions">
      <button type="button" class="text-link" (click)="downloadTemplateFile()">
        Download Template
      </button>
    </div>

    <p class="hint">Expected columns (sheet <code>Clients</code>):</p>
    <p class="hint">
      <code>ID</code>, <code>Full Name</code>, <code>Display Name</code>, <code>Email</code>,
      <code>Details</code>, <code>Active</code>, <code>Location</code>, <code>Country</code>.<br />
      Note: <code>ID</code> is ignored on import.
    </p>

    @if (rows().length) {
    <p class="summary" aria-live="polite">
      Parsed <b>{{ rows().length }}</b> rows.
      @if (imported()) { <span> Imported: {{ imported() }}</span> }
    </p>

    <table class="preview">
      <thead>
        <tr>
          <th>Display Name</th>
          <th>Email</th>
          <th>Active</th>
          <th>Country</th>
        </tr>
      </thead>
      <tbody>
        @for (r of preview(); track $index) {
        <tr>
          <td>{{ r.displayName }}</td>
          <td>{{ r.email }}</td>
          <td>{{ r.active }}</td>
          <td>{{ r.country }}</td>
        </tr>
        }
      </tbody>
    </table>
    }
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button type="button" cdkFocusInitial (click)="close()" [disabled]="loading()">
    Cancel
  </button>
  <button mat-flat-button type="button" class="btn-save" color="primary" (click)="importNow()"
    [disabled]="!canImport()">
    Import
  </button>
</mat-dialog-actions>